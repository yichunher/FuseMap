Search.setIndex({"alltitles": {"1. Prepare software and data": [[19, "1.-Prepare-software-and-data"]], "2. Read data": [[19, "2.-Read-data"]], "3. Spatial integrate": [[19, "3.-Spatial-integrate"]], "API Reference": [[1, null]], "About": [[0, null]], "And more!": [[2, "and-more"]], "Authors": [[0, "authors"]], "Contents": [[2, null]], "Core Functionality": [[1, "core-functionality"]], "Downloading the pretrained models": [[3, "downloading-the-pretrained-models"]], "FuseMap": [[5, null]], "How to Cite": [[0, "how-to-cite"]], "Impute spatial gene expression": [[17, null]], "Indices": [[2, "indices"]], "Installation": [[3, null]], "Installing the package": [[3, "installing-the-package"]], "Integrate cells and tissues across organs and species": [[18, null]], "Integrate cells and tissues in adult mouse brain across atlases": [[19, null]], "Map cells and tissues across human/mouse or organs": [[21, null]], "Map cells and tissues to molCCF": [[20, null]], "Spatial integration": [[2, "spatial-integration"]], "Spatial integration and mapping with universal gene, cell, and tissue embeddings.": [[2, "spatial-integration-and-mapping-with-universal-gene-cell-and-tissue-embeddings"]], "Spatial mapping": [[2, "spatial-mapping"]], "Support": [[0, "support"]], "Tutorials": [[22, null]], "Usage": [[2, "usage"]], "Welcome to FuseMap\u2019s documentation!": [[2, null]], "fusemap.config module": [[6, null]], "fusemap.dataset module": [[7, null]], "fusemap.logger module": [[8, null]], "fusemap.loss module": [[9, null]], "fusemap.model module": [[10, null]], "fusemap.preprocess module": [[11, null]], "fusemap.spatial_integrate module": [[12, null]], "fusemap.spatial_map module": [[13, null]], "fusemap.train module": [[14, null]], "fusemap.train_model module": [[15, null]], "fusemap.utils module": [[16, null]], "main module": [[4, null]]}, "docnames": ["about", "api", "index", "install", "main", "modules", "modules/config", "modules/dataset", "modules/logger", "modules/loss", "modules/model", "modules/preprocess", "modules/spatial_integrate", "modules/spatial_map", "modules/train", "modules/train_model", "modules/utils", "notebooks/spatial_impute", "notebooks/spatial_integrate_species", "notebooks/spatial_integrate_tech", "notebooks/spatial_map_mousebrain", "notebooks/spatial_map_mousehuman", "tutorials"], "envversion": {"nbsphinx": 4, "sphinx": 63, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1}, "filenames": ["about.rst", "api.rst", "index.rst", "install.rst", "main.rst", "modules.rst", "modules/config.rst", "modules/dataset.rst", "modules/logger.rst", "modules/loss.rst", "modules/model.rst", "modules/preprocess.rst", "modules/spatial_integrate.rst", "modules/spatial_map.rst", "modules/train.rst", "modules/train_model.rst", "modules/utils.rst", "notebooks/spatial_impute.ipynb", "notebooks/spatial_integrate_species.ipynb", "notebooks/spatial_integrate_tech.ipynb", "notebooks/spatial_map_mousebrain.ipynb", "notebooks/spatial_map_mousehuman.ipynb", "tutorials.rst"], "indexentries": {"add_adaptdecoder_module() (fusemap.model.fuse_network method)": [[10, "fusemap.model.Fuse_network.add_adaptdecoder_module", false]], "add_decoder_module() (fusemap.model.fuse_network method)": [[10, "fusemap.model.Fuse_network.add_decoder_module", false]], "add_encoder_module() (fusemap.model.fuse_network method)": [[10, "fusemap.model.Fuse_network.add_encoder_module", false]], "add_pretrain_to_name() (in module fusemap.train_model)": [[15, "fusemap.train_model.add_pretrain_to_name", false]], "adj_model (class in fusemap.model)": [[10, "fusemap.model.Adj_model", false]], "ae_gene_loss() (in module fusemap.loss)": [[9, "fusemap.loss.AE_Gene_loss", false]], "align_anneal (fusemap.config.flagconfig attribute)": [[6, "fusemap.config.FlagConfig.align_anneal", false]], "align_noise_coef (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.align_noise_coef", false]], "average_embeddings() (in module fusemap.utils)": [[16, "fusemap.utils.average_embeddings", false]], "balance_weight() (in module fusemap.train_model)": [[15, "fusemap.train_model.balance_weight", false]], "batch_size (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.batch_size", false]], "compute_ae_loss() (in module fusemap.loss)": [[9, "fusemap.loss.compute_ae_loss", false]], "compute_ae_loss_map() (in module fusemap.loss)": [[9, "fusemap.loss.compute_ae_loss_map", false]], "compute_ae_loss_pretrain() (in module fusemap.loss)": [[9, "fusemap.loss.compute_ae_loss_pretrain", false]], "compute_dis_loss() (in module fusemap.loss)": [[9, "fusemap.loss.compute_dis_loss", false]], "compute_dis_loss_map() (in module fusemap.loss)": [[9, "fusemap.loss.compute_dis_loss_map", false]], "compute_dis_loss_pretrain() (in module fusemap.loss)": [[9, "fusemap.loss.compute_dis_loss_pretrain", false]], "compute_gene_embedding_loss() (in module fusemap.loss)": [[9, "fusemap.loss.compute_gene_embedding_loss", false]], "construct_data() (in module fusemap.dataset)": [[7, "fusemap.dataset.construct_data", false]], "construct_graph() (in module fusemap.preprocess)": [[11, "fusemap.preprocess.construct_graph", false]], "construct_mask() (in module fusemap.dataset)": [[7, "fusemap.dataset.construct_mask", false]], "customgraphdataloader (class in fusemap.dataset)": [[7, "fusemap.dataset.CustomGraphDataLoader", false]], "customgraphdataset (class in fusemap.dataset)": [[7, "fusemap.dataset.CustomGraphDataset", false]], "dis_lamda (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.DIS_LAMDA", false]], "discriminator (class in fusemap.model)": [[10, "fusemap.model.Discriminator", false]], "dropout_rate (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.dropout_rate", false]], "eps (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.EPS", false]], "filter() (fusemap.logger.multipleheaderfilter method)": [[8, "fusemap.logger.MultipleHeaderFilter.filter", false]], "flagconfig (class in fusemap.config)": [[6, "fusemap.config.FlagConfig", false]], "forward() (fusemap.model.adj_model method)": [[10, "fusemap.model.Adj_model.forward", false]], "forward() (fusemap.model.discriminator method)": [[10, "fusemap.model.Discriminator.forward", false]], "forward() (fusemap.model.fusemapadaptdecoder method)": [[10, "fusemap.model.FuseMapAdaptDecoder.forward", false]], "forward() (fusemap.model.fusemapdecoder method)": [[10, "fusemap.model.FuseMapDecoder.forward", false]], "forward() (fusemap.model.fusemapencoder method)": [[10, "fusemap.model.FuseMapEncoder.forward", false]], "forward() (fusemap.model.nntransfer method)": [[10, "fusemap.model.NNTransfer.forward", false]], "fuse_network (class in fusemap.model)": [[10, "fusemap.model.Fuse_network", false]], "fusemap.config": [[6, "module-fusemap.config", false]], "fusemap.dataset": [[7, "module-fusemap.dataset", false]], "fusemap.logger": [[8, "module-fusemap.logger", false]], "fusemap.loss": [[9, "module-fusemap.loss", false]], "fusemap.model": [[10, "module-fusemap.model", false]], "fusemap.preprocess": [[11, "module-fusemap.preprocess", false]], "fusemap.spatial_integrate": [[12, "module-fusemap.spatial_integrate", false]], "fusemap.spatial_map": [[13, "module-fusemap.spatial_map", false]], "fusemap.train": [[14, "module-fusemap.train", false]], "fusemap.train_model": [[15, "module-fusemap.train_model", false]], "fusemap.utils": [[16, "module-fusemap.utils", false]], "fusemapadaptdecoder (class in fusemap.model)": [[10, "fusemap.model.FuseMapAdaptDecoder", false]], "fusemapdecoder (class in fusemap.model)": [[10, "fusemap.model.FuseMapDecoder", false]], "fusemapencoder (class in fusemap.model)": [[10, "fusemap.model.FuseMapEncoder", false]], "generate_ad_embed() (in module fusemap.utils)": [[16, "fusemap.utils.generate_ad_embed", false]], "get_allunique_gene_names() (in module fusemap.preprocess)": [[11, "fusemap.preprocess.get_allunique_gene_names", false]], "get_balance_weight() (in module fusemap.loss)": [[9, "fusemap.loss.get_balance_weight", false]], "get_balance_weight_subsample() (in module fusemap.loss)": [[9, "fusemap.loss.get_balance_weight_subsample", false]], "get_data() (in module fusemap.train_model)": [[15, "fusemap.train_model.get_data", false]], "get_feature_sparse() (in module fusemap.dataset)": [[7, "fusemap.dataset.get_feature_sparse", false]], "get_spatial_input() (in module fusemap.preprocess)": [[11, "fusemap.preprocess.get_spatial_input", false]], "get_unique_gene_indices() (in module fusemap.preprocess)": [[11, "fusemap.preprocess.get_unique_gene_indices", false]], "hidden_dim (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.hidden_dim", false]], "lambda_ae_single (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.lambda_ae_single", false]], "lambda_ae_spatial (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.lambda_ae_spatial", false]], "lambda_disc_single (fusemap.config.flagconfig attribute)": [[6, "fusemap.config.FlagConfig.lambda_disc_single", false]], "lambda_disc_spatial (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.lambda_disc_spatial", false]], "latent_dim (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.latent_dim", false]], "learning_rate (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.learning_rate", false]], "load_ref_data() (in module fusemap.train_model)": [[15, "fusemap.train_model.load_ref_data", false]], "load_ref_model() (in module fusemap.train_model)": [[15, "fusemap.train_model.load_ref_model", false]], "load_snapshot() (in module fusemap.utils)": [[16, "fusemap.utils.load_snapshot", false]], "lr_factor_final (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.lr_factor_final", false]], "lr_factor_pretrain (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.lr_factor_pretrain", false]], "lr_limit_final (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.lr_limit_final", false]], "lr_limit_pretrain (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.lr_limit_pretrain", false]], "lr_patience_final (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.lr_patience_final", false]], "lr_patience_pretrain (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.lr_patience_pretrain", false]], "map_model() (in module fusemap.train_model)": [[15, "fusemap.train_model.map_model", false]], "mappretraindataloader (class in fusemap.dataset)": [[7, "fusemap.dataset.MapPretrainDataLoader", false]], "mappretraindataset (class in fusemap.dataset)": [[7, "fusemap.dataset.MapPretrainDataset", false]], "modeltype (class in fusemap.config)": [[6, "fusemap.config.ModelType", false]], "module": [[6, "module-fusemap.config", false], [7, "module-fusemap.dataset", false], [8, "module-fusemap.logger", false], [9, "module-fusemap.loss", false], [10, "module-fusemap.model", false], [11, "module-fusemap.preprocess", false], [12, "module-fusemap.spatial_integrate", false], [13, "module-fusemap.spatial_map", false], [14, "module-fusemap.train", false], [15, "module-fusemap.train_model", false], [16, "module-fusemap.utils", false]], "multipleheaderfilter (class in fusemap.logger)": [[8, "fusemap.logger.MultipleHeaderFilter", false]], "n_epochs (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.n_epochs", false]], "nntransfer (class in fusemap.model)": [[10, "fusemap.model.NNTransfer", false]], "optim_kw (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.optim_kw", false]], "parse_input_args() (in module fusemap.config)": [[6, "fusemap.config.parse_input_args", false]], "patience_limit_final (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.patience_limit_final", false]], "patience_limit_pretrain (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.patience_limit_pretrain", false]], "pca_dim (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.pca_dim", false]], "preprocess_adata() (in module fusemap.preprocess)": [[11, "fusemap.preprocess.preprocess_adata", false]], "preprocess_adj_sparse() (in module fusemap.preprocess)": [[11, "fusemap.preprocess.preprocess_adj_sparse", false]], "preprocess_raw() (in module fusemap.preprocess)": [[11, "fusemap.preprocess.preprocess_raw", false]], "pretrain_model() (in module fusemap.train_model)": [[15, "fusemap.train_model.pretrain_model", false]], "prod() (in module fusemap.loss)": [[9, "fusemap.loss.prod", false]], "read_cell_embedding() (in module fusemap.utils)": [[16, "fusemap.utils.read_cell_embedding", false]], "read_gene_embedding() (in module fusemap.utils)": [[16, "fusemap.utils.read_gene_embedding", false]], "read_gene_embedding_map() (in module fusemap.utils)": [[16, "fusemap.utils.read_gene_embedding_map", false]], "read_model() (in module fusemap.train_model)": [[15, "fusemap.train_model.read_model", false]], "reset_parameters() (in module fusemap.model)": [[10, "fusemap.model.reset_parameters", false]], "save_obj() (in module fusemap.utils)": [[16, "fusemap.utils.save_obj", false]], "save_snapshot() (in module fusemap.utils)": [[16, "fusemap.utils.save_snapshot", false]], "seed_all() (in module fusemap.utils)": [[16, "fusemap.utils.seed_all", false]], "setup_logging() (in module fusemap.logger)": [[8, "fusemap.logger.setup_logging", false]], "spatial_integrate() (in module fusemap.spatial_integrate)": [[12, "fusemap.spatial_integrate.spatial_integrate", false]], "spatial_map() (in module fusemap.spatial_map)": [[13, "fusemap.spatial_map.spatial_map", false]], "train() (in module fusemap.train)": [[14, "fusemap.train.train", false]], "train_model() (in module fusemap.train_model)": [[15, "fusemap.train_model.train_model", false]], "train_without_eval (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.TRAIN_WITHOUT_EVAL", false]], "transfer_annotation() (in module fusemap.utils)": [[16, "fusemap.utils.transfer_annotation", false]], "transfer_weight() (in module fusemap.train_model)": [[15, "fusemap.train_model.transfer_weight", false]], "use_input (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.use_input", false]], "use_reference_pct (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.USE_REFERENCE_PCT", false]], "verbose (fusemap.config.modeltype attribute)": [[6, "fusemap.config.ModelType.verbose", false]]}, "objects": {"fusemap": [[6, 0, 0, "-", "config"], [7, 0, 0, "-", "dataset"], [8, 0, 0, "-", "logger"], [9, 0, 0, "-", "loss"], [10, 0, 0, "-", "model"], [11, 0, 0, "-", "preprocess"], [12, 0, 0, "-", "spatial_integrate"], [13, 0, 0, "-", "spatial_map"], [14, 0, 0, "-", "train"], [15, 0, 0, "-", "train_model"], [16, 0, 0, "-", "utils"]], "fusemap.config": [[6, 1, 1, "", "FlagConfig"], [6, 1, 1, "", "ModelType"], [6, 3, 1, "", "parse_input_args"]], "fusemap.config.FlagConfig": [[6, 2, 1, "", "align_anneal"], [6, 2, 1, "", "lambda_disc_single"]], "fusemap.config.ModelType": [[6, 2, 1, "", "DIS_LAMDA"], [6, 2, 1, "", "EPS"], [6, 2, 1, "", "TRAIN_WITHOUT_EVAL"], [6, 2, 1, "", "USE_REFERENCE_PCT"], [6, 2, 1, "", "align_noise_coef"], [6, 2, 1, "", "batch_size"], [6, 2, 1, "", "dropout_rate"], [6, 2, 1, "", "hidden_dim"], [6, 2, 1, "", "lambda_ae_single"], [6, 2, 1, "", "lambda_ae_spatial"], [6, 2, 1, "", "lambda_disc_spatial"], [6, 2, 1, "", "latent_dim"], [6, 2, 1, "", "learning_rate"], [6, 2, 1, "", "lr_factor_final"], [6, 2, 1, "", "lr_factor_pretrain"], [6, 2, 1, "", "lr_limit_final"], [6, 2, 1, "", "lr_limit_pretrain"], [6, 2, 1, "", "lr_patience_final"], [6, 2, 1, "", "lr_patience_pretrain"], [6, 2, 1, "", "n_epochs"], [6, 2, 1, "", "optim_kw"], [6, 2, 1, "", "patience_limit_final"], [6, 2, 1, "", "patience_limit_pretrain"], [6, 2, 1, "", "pca_dim"], [6, 2, 1, "", "use_input"], [6, 2, 1, "", "verbose"]], "fusemap.dataset": [[7, 1, 1, "", "CustomGraphDataLoader"], [7, 1, 1, "", "CustomGraphDataset"], [7, 1, 1, "", "MapPretrainDataLoader"], [7, 1, 1, "", "MapPretrainDataset"], [7, 3, 1, "", "construct_data"], [7, 3, 1, "", "construct_mask"], [7, 3, 1, "", "get_feature_sparse"]], "fusemap.logger": [[8, 1, 1, "", "MultipleHeaderFilter"], [8, 3, 1, "", "setup_logging"]], "fusemap.logger.MultipleHeaderFilter": [[8, 4, 1, "", "filter"]], "fusemap.loss": [[9, 3, 1, "", "AE_Gene_loss"], [9, 3, 1, "", "compute_ae_loss"], [9, 3, 1, "", "compute_ae_loss_map"], [9, 3, 1, "", "compute_ae_loss_pretrain"], [9, 3, 1, "", "compute_dis_loss"], [9, 3, 1, "", "compute_dis_loss_map"], [9, 3, 1, "", "compute_dis_loss_pretrain"], [9, 3, 1, "", "compute_gene_embedding_loss"], [9, 3, 1, "", "get_balance_weight"], [9, 3, 1, "", "get_balance_weight_subsample"], [9, 3, 1, "", "prod"]], "fusemap.model": [[10, 1, 1, "", "Adj_model"], [10, 1, 1, "", "Discriminator"], [10, 1, 1, "", "FuseMapAdaptDecoder"], [10, 1, 1, "", "FuseMapDecoder"], [10, 1, 1, "", "FuseMapEncoder"], [10, 1, 1, "", "Fuse_network"], [10, 1, 1, "", "NNTransfer"], [10, 3, 1, "", "reset_parameters"]], "fusemap.model.Adj_model": [[10, 4, 1, "", "forward"]], "fusemap.model.Discriminator": [[10, 4, 1, "", "forward"]], "fusemap.model.FuseMapAdaptDecoder": [[10, 4, 1, "", "forward"]], "fusemap.model.FuseMapDecoder": [[10, 4, 1, "", "forward"]], "fusemap.model.FuseMapEncoder": [[10, 4, 1, "", "forward"]], "fusemap.model.Fuse_network": [[10, 4, 1, "", "add_adaptdecoder_module"], [10, 4, 1, "", "add_decoder_module"], [10, 4, 1, "", "add_encoder_module"]], "fusemap.model.NNTransfer": [[10, 4, 1, "", "forward"]], "fusemap.preprocess": [[11, 3, 1, "", "construct_graph"], [11, 3, 1, "", "get_allunique_gene_names"], [11, 3, 1, "", "get_spatial_input"], [11, 3, 1, "", "get_unique_gene_indices"], [11, 3, 1, "", "preprocess_adata"], [11, 3, 1, "", "preprocess_adj_sparse"], [11, 3, 1, "", "preprocess_raw"]], "fusemap.spatial_integrate": [[12, 3, 1, "", "spatial_integrate"]], "fusemap.spatial_map": [[13, 3, 1, "", "spatial_map"]], "fusemap.train": [[14, 3, 1, "", "train"]], "fusemap.train_model": [[15, 3, 1, "", "add_pretrain_to_name"], [15, 3, 1, "", "balance_weight"], [15, 3, 1, "", "get_data"], [15, 3, 1, "", "load_ref_data"], [15, 3, 1, "", "load_ref_model"], [15, 3, 1, "", "map_model"], [15, 3, 1, "", "pretrain_model"], [15, 3, 1, "", "read_model"], [15, 3, 1, "", "train_model"], [15, 3, 1, "", "transfer_weight"]], "fusemap.utils": [[16, 3, 1, "", "average_embeddings"], [16, 3, 1, "", "generate_ad_embed"], [16, 3, 1, "", "load_snapshot"], [16, 3, 1, "", "read_cell_embedding"], [16, 3, 1, "", "read_gene_embedding"], [16, 3, 1, "", "read_gene_embedding_map"], [16, 3, 1, "", "save_obj"], [16, 3, 1, "", "save_snapshot"], [16, 3, 1, "", "seed_all"], [16, 3, 1, "", "transfer_annotation"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "attribute", "Python attribute"], "3": ["py", "function", "Python function"], "4": ["py", "method", "Python method"]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:attribute", "3": "py:function", "4": "py:method"}, "terms": {"": [15, 19, 22], "0": [6, 10, 15], "000": 3, "001": 6, "02": 6, "05": [0, 6], "1": [2, 3, 6, 10, 15], "10": [0, 6], "10000000000": 6, "1101": 0, "16": 6, "1e": 6, "2": [2, 6], "2024": 0, "27": 0, "3": 6, "300": 3, "5": 6, "50": 6, "512": 6, "594872": 0, "64": 6, "A": 3, "If": 8, "The": 3, "These": 1, "To": 0, "about": 2, "acceler": 3, "across": 2, "adapt_model": [9, 15], "adata": [7, 9, 11, 15, 16], "adatas_": 9, "add_adaptdecoder_modul": 10, "add_decoder_modul": 10, "add_encoder_modul": 10, "add_pretrain_to_nam": 15, "adj": 10, "adj_al": [9, 15], "adj_model": 10, "ae_gene_loss": 9, "align_ann": 6, "align_noise_coef": 6, "all_unique_gen": 16, "an": 6, "anneal": 9, "api": 2, "appropri": 8, "arg": [7, 10, 12, 13], "atla": [0, 2], "author": 2, "average_embed": 16, "balance_weight": 15, "balance_weight_single_block": 9, "balance_weight_spatial_block": 9, "base": [6, 7, 8, 10], "basic": 19, "batch_features_al": 9, "batch_siz": [6, 7, 15], "biorxiv": 0, "blocks_al": 15, "brain": [0, 2, 3], "bridg": 2, "can": [0, 3], "categori": 16, "cd": 3, "cell": 3, "check": 2, "cite": 2, "class": [6, 7, 8, 10], "clone": 3, "com": 3, "comput": 3, "compute_ae_loss": 9, "compute_ae_loss_map": 9, "compute_ae_loss_pretrain": 9, "compute_dis_loss": 9, "compute_dis_loss_map": 9, "compute_dis_loss_pretrain": 9, "compute_gene_embedding_loss": 9, "configur": 8, "consol": 8, "consolid": 2, "construct_data": 7, "construct_graph": 11, "construct_mask": 7, "context": 2, "core": 2, "cuda_determinist": 16, "customgraphdataload": 7, "customgraphdataset": 7, "data_pth": [11, 12, 13, 14], "dataloader_pretrain_singl": 15, "dataloader_pretrain_spati": 15, "dataset_al": 7, "deem": 8, "deep": 2, "determin": 8, "devic": [7, 15], "directori": 3, "dis_lamda": 6, "discrimin": 10, "doi": 0, "download": [2, 19], "drop_last": 7, "dropout_r": [6, 10], "e": 3, "enum": 6, "enumer": 6, "ep": 6, "epoch_fin": 16, "epoch_pretrain": 16, "estim": 3, "exampl": [2, 19], "explanatori": 22, "express": 2, "fals": [6, 8, 14], "familiar": 19, "featur": 7, "feature_al": 15, "file": 8, "filter": 8, "final": 16, "flag_source_cat_singl": 9, "flag_source_cat_single_pretrain": 9, "flag_source_cat_spati": 9, "flag_source_cat_spatial_pretrain": 9, "flagconfig": [6, 9, 15], "follow": 3, "forward": 10, "framework": 2, "from": [3, 19], "function": [2, 19, 22], "fuse_network": 10, "fusemap": [0, 1, 3, 19, 22], "fusemapadaptdecod": 10, "fusemapdecod": 10, "fusemapencod": 10, "g_all": [7, 15], "gene_embed": 10, "gene_embedding_new": 10, "gene_embedding_pretrain": 10, "gene_list": 11, "gene_new": 10, "gene_pretrain": 10, "generate_ad_emb": 16, "get_allunique_gene_nam": 11, "get_balance_weight": 9, "get_balance_weight_subsampl": 9, "get_data": 15, "get_feature_spars": 7, "get_spatial_input": 11, "get_unique_gene_indic": 11, "git": 3, "github": [0, 3], "gpu": 3, "hail": 0, "hao": 0, "he": 0, "here": 19, "hidden_dim": [6, 10], "hour": 3, "how": 2, "http": [0, 3], "human": [2, 3], "i": [2, 3, 8], "ignor": 8, "imput": 2, "includ": 1, "index": 2, "input_dim": 10, "input_ident": [7, 11, 12, 13, 14], "instal": 2, "integr": [3, 22], "issu": 0, "jia": 0, "keep_celltyp": 16, "keep_label": 16, "keep_tissueregion": 16, "kei": 10, "key_leiden_categori": 9, "kneighbor": [11, 12, 13, 14], "kwarg": [7, 10], "lambda_ae_singl": 6, "lambda_ae_spati": 6, "lambda_disc_singl": 6, "lambda_disc_spati": 6, "latent_dim": [6, 10], "learn": 2, "learning_r": 6, "leiden_adata_singl": 9, "list": 8, "liu": 0, "load_ref_data": 15, "load_ref_model": 15, "load_snapshot": 16, "loc": 16, "local": 3, "log": 8, "lr_factor_fin": 6, "lr_factor_pretrain": 6, "lr_limit_fin": 6, "lr_limit_pretrain": 6, "lr_patience_fin": 6, "lr_patience_pretrain": 6, "mai": 8, "main": 5, "manner": 3, "map": 22, "map_model": 15, "mappretraindataload": 7, "mappretraindataset": 7, "mask_batch_singl": 9, "mask_batch_spati": 9, "messag": 8, "mode": 15, "model": [2, 7, 9, 15, 16], "modeltyp": [6, 15], "modifi": 8, "modul": [1, 2, 5], "molccf_path": [13, 16], "molecular": 0, "mous": [0, 2, 3], "multipleheaderfilt": 8, "n_atla": [7, 11, 15, 16], "n_epoch": 6, "name": 16, "necessari": 3, "new_train_gen": 16, "nntransfer": 10, "none": [8, 11, 12, 13, 14], "norm": 6, "notebook": 22, "object": [6, 7], "objt": 16, "obsm_lat": 16, "optim_kw": 6, "org": 0, "organ": [2, 3], "otherwis": 8, "our": 0, "out": [2, 8], "overview": 2, "packag": 2, "panel": 2, "para": 10, "paramet": 8, "parse_input_arg": 6, "path": 8, "patience_limit_fin": 6, "patience_limit_pretrain": 6, "pattern": 8, "patterns_to_filt": 8, "pca_dim": 6, "perform": 3, "pip": 3, "place": 8, "pleas": 0, "preprocess_adata": 11, "preprocess_adj_spars": 11, "preprocess_raw": 11, "preprocess_sav": 14, "pretrain": 2, "pretrain_index": 15, "pretrain_model": 15, "pretrain_single_batch": 9, "pretrain_spatial_batch": 9, "pretrained_gen": 16, "prod": 9, "provid": [1, 2, 22], "public": 0, "put": 3, "quick": 3, "read_cell_embed": 16, "read_gene_embed": 16, "read_gene_embedding_map": 16, "read_model": 15, "recon_x": 9, "record": 8, "ref_dir": 15, "refer": 2, "regex": 8, "report": 0, "reset_paramet": 10, "return": 8, "rmsprop": 6, "sample_gene_list": 11, "sampler": 7, "save": 8, "save_dir": [14, 15, 16], "save_obj": 16, "save_path": 8, "save_snapshot": 16, "section": 19, "seed_al": 16, "seed_valu": 16, "setup_log": 8, "sheng": 0, "shi": 0, "should": 8, "shuffl": 7, "singl": [2, 3], "snapshot_path": 16, "sourc": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "spatial": [0, 22], "spatial_dataload": 15, "spatial_dataloader_test": 15, "spatial_dataset_list": 7, "spatial_integr": [1, 2], "spatial_map": [1, 2], "speci": 2, "specifi": 8, "spot": 2, "support": 2, "tang": 0, "task": 1, "technologi": 2, "thi": 19, "time": 3, "toward": 0, "tracker": 0, "train_mask": 15, "train_without_ev": 6, "trained_model": 15, "trained_x_num": 15, "transcriptom": 2, "transfer_annot": 16, "transfer_weight": 15, "true": [8, 16], "ttype": 16, "tutori": [2, 19], "univers": 0, "us": [0, 3, 19], "use_input": [6, 11], "use_kei": 16, "use_reference_pct": [6, 15], "user": 19, "usual": 3, "val_mask": 15, "valu": 6, "var_index": 10, "var_nam": 16, "varieti": 1, "variou": 2, "verbos": [6, 16], "wang": 0, "we": [19, 22], "wendi": 0, "where": 8, "within": 2, "x": [9, 10], "x_input": [11, 12, 13, 14, 16], "xiao": 0, "xueyi": 0, "xx": [1, 3, 19], "xxx": [2, 19], "yichun": 0, "yichunh": 3, "you": [0, 3], "z": 10, "z_distribut": 9, "z_spatial": 10, "zefang": 0, "zenodo": 3}, "titles": ["About", "API Reference", "Welcome to FuseMap\u2019s documentation!", "Installation", "main module", "FuseMap", "fusemap.config module", "fusemap.dataset module", "fusemap.logger module", "fusemap.loss module", "fusemap.model module", "fusemap.preprocess module", "fusemap.spatial_integrate module", "fusemap.spatial_map module", "fusemap.train module", "fusemap.train_model module", "fusemap.utils module", "Impute spatial gene expression", "Integrate cells and tissues across organs and species", "Integrate cells and tissues in adult mouse brain across atlases", "Map cells and tissues to molCCF", "Map cells and tissues across human/mouse or organs", "Tutorials"], "titleterms": {"": 2, "1": 19, "2": 19, "3": 19, "And": 2, "about": 0, "across": [18, 19, 21], "adult": 19, "api": 1, "atlas": 19, "author": 0, "brain": 19, "cell": [2, 18, 19, 20, 21], "cite": 0, "config": 6, "content": 2, "core": 1, "data": 19, "dataset": 7, "document": 2, "download": 3, "embed": 2, "express": 17, "function": 1, "fusemap": [2, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "gene": [2, 17], "how": 0, "human": 21, "imput": 17, "indic": 2, "instal": 3, "integr": [2, 18, 19], "logger": 8, "loss": 9, "main": 4, "map": [2, 20, 21], "model": [3, 10], "modul": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "molccf": 20, "more": 2, "mous": [19, 21], "organ": [18, 21], "packag": 3, "prepar": 19, "preprocess": 11, "pretrain": 3, "read": 19, "refer": 1, "softwar": 19, "spatial": [2, 17, 19], "spatial_integr": 12, "spatial_map": 13, "speci": 18, "support": 0, "tissu": [2, 18, 19, 20, 21], "train": 14, "train_model": 15, "tutori": 22, "univers": 2, "usag": 2, "util": 16, "welcom": 2}})