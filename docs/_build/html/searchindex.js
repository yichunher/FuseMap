Search.setIndex({"alltitles": {"1. Prepare software and data": [[17, "1.-Prepare-software-and-data"]], "2. Read data": [[17, "2.-Read-data"]], "3. Spatial integrate": [[17, "3.-Spatial-integrate"]], "API Reference": [[1, null]], "About": [[0, null]], "Authors": [[0, "authors"]], "Contents": [[2, "contents"]], "Core Functionality": [[1, "core-functionality"]], "Downloading the pretrained models": [[3, "downloading-the-pretrained-models"]], "FuseMap": [[2, null]], "How to Cite": [[0, "how-to-cite"]], "Impute spatial gene expression": [[15, null]], "Installation": [[3, null]], "Installing the package": [[3, "installing-the-package"]], "Integrate cells and tissues across organs and species": [[16, null]], "Integrate cells and tissues in adult mouse brain across atlases": [[17, null]], "Map cells and tissues across human/mouse or organs": [[19, null]], "Map cells and tissues to molCCF": [[18, null]], "Model Training": [[1, "model-training"]], "Quick start": [[2, "quick-start"]], "Spatial integration": [[2, "spatial-integration"]], "Spatial integration and mapping with universal gene, cell, and tissue embeddings.": [[2, "spatial-integration-and-mapping-with-universal-gene-cell-and-tissue-embeddings"]], "Spatial mapping": [[2, "spatial-mapping"]], "Step-by-step guide": [[2, "step-by-step-guide"]], "Support": [[0, "support"]], "Tutorials": [[20, null]], "Utilities": [[1, "utilities"]], "fusemap.config module": [[4, null]], "fusemap.dataset module": [[5, null]], "fusemap.logger module": [[6, null]], "fusemap.loss module": [[7, null]], "fusemap.model module": [[8, null]], "fusemap.preprocess module": [[9, null]], "fusemap.spatial_integrate module": [[10, null]], "fusemap.spatial_map module": [[11, null]], "fusemap.train module": [[12, null]], "fusemap.train_model module": [[13, null]], "fusemap.utils module": [[14, null]]}, "docnames": ["about", "api", "index", "install", "modules/config", "modules/dataset", "modules/logger", "modules/loss", "modules/model", "modules/preprocess", "modules/spatial_integrate", "modules/spatial_map", "modules/train", "modules/train_model", "modules/utils", "notebooks/spatial_impute", "notebooks/spatial_integrate_species", "notebooks/spatial_integrate_tech", "notebooks/spatial_map_mousebrain", "notebooks/spatial_map_mousehuman", "tutorials"], "envversion": {"nbsphinx": 4, "sphinx": 63, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1}, "filenames": ["about.rst", "api.rst", "index.rst", "install.rst", "modules/config.rst", "modules/dataset.rst", "modules/logger.rst", "modules/loss.rst", "modules/model.rst", "modules/preprocess.rst", "modules/spatial_integrate.rst", "modules/spatial_map.rst", "modules/train.rst", "modules/train_model.rst", "modules/utils.rst", "notebooks/spatial_impute.ipynb", "notebooks/spatial_integrate_species.ipynb", "notebooks/spatial_integrate_tech.ipynb", "notebooks/spatial_map_mousebrain.ipynb", "notebooks/spatial_map_mousehuman.ipynb", "tutorials.rst"], "indexentries": {}, "objects": {"fusemap": [[6, 0, 0, "-", "logger"], [8, 0, 0, "-", "model"], [9, 0, 0, "-", "preprocess"]], "fusemap.logger": [[6, 1, 1, "", "MultipleHeaderFilter"], [6, 3, 1, "", "setup_logging"]], "fusemap.logger.MultipleHeaderFilter": [[6, 2, 1, "", "filter"]], "fusemap.model": [[8, 1, 1, "", "Adj_model"], [8, 1, 1, "", "Discriminator"], [8, 1, 1, "", "FuseMapAdaptDecoder"], [8, 1, 1, "", "FuseMapDecoder"], [8, 1, 1, "", "FuseMapEncoder"], [8, 1, 1, "", "Fuse_network"], [8, 1, 1, "", "NNTransfer"], [8, 3, 1, "", "reset_parameters"]], "fusemap.model.Adj_model": [[8, 2, 1, "", "forward"]], "fusemap.model.Discriminator": [[8, 2, 1, "", "forward"]], "fusemap.model.FuseMapAdaptDecoder": [[8, 2, 1, "", "forward"]], "fusemap.model.FuseMapDecoder": [[8, 2, 1, "", "forward"]], "fusemap.model.FuseMapEncoder": [[8, 2, 1, "", "forward"]], "fusemap.model.Fuse_network": [[8, 2, 1, "", "add_adaptdecoder_module"], [8, 2, 1, "", "add_decoder_module"], [8, 2, 1, "", "add_encoder_module"]], "fusemap.model.NNTransfer": [[8, 2, 1, "", "forward"]], "fusemap.preprocess": [[9, 3, 1, "", "construct_graph"], [9, 3, 1, "", "get_allunique_gene_names"], [9, 3, 1, "", "get_spatial_input"], [9, 3, 1, "", "get_unique_gene_indices"], [9, 3, 1, "", "preprocess_adata"], [9, 3, 1, "", "preprocess_adj_sparse"], [9, 3, 1, "", "preprocess_raw"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function"}, "terms": {"": [17, 20], "0": 8, "000": 3, "0000": [], "001": [], "02": [], "05": 0, "1": [2, 3, 8], "10": [0, 3, 8], "100": 8, "10000000000": [], "1101": 0, "16": [], "1e": [], "2": [2, 8], "20": 8, "200": 8, "2024": 0, "24": [], "27": 0, "3": [3, 8], "300": 3, "4": [], "5": [], "50": 8, "512": [], "594872": 0, "64": [], "A": [3, 9], "If": 6, "The": [3, 8, 9], "These": 1, "To": 0, "_": 8, "about": 2, "acceler": 3, "across": 2, "activ": 3, "adapt": 8, "adapt_model": [], "adata": 9, "adatas_": [], "add": 8, "add_adaptdecoder_modul": 8, "add_decoder_modul": 8, "add_encoder_modul": 8, "add_pretrain_to_nam": [], "adj": 8, "adj_al": [], "adj_coo": [], "adj_model": 8, "adjac": 8, "ae_gene_loss": [], "align_ann": [], "align_noise_coef": [], "all": 8, "all_unique_gen": 8, "an": 8, "analysi": 2, "ani": 2, "anndata": 9, "anneal": [], "api": 2, "appropri": 6, "arg": 8, "argpars": [], "argument": [], "atla": [0, 2], "atlas": [8, 9], "atlas1": 8, "author": 2, "autoencod": [], "averag": [], "average_embed": [], "balanc": [], "balance_weight": [], "balance_weight_single_block": [], "balance_weight_spatial_block": [], "base": [6, 8], "basic": 17, "batch_features_al": [], "batch_siz": [], "biorxiv": 0, "blocks_al": [], "bool": 8, "brain": [0, 2, 3], "bridg": 2, "calcul": 9, "can": [0, 2, 3], "categori": [], "cd": [], "cell": 3, "cell_typ": [], "check": 2, "cite": 2, "class": [6, 8], "clone": [], "cluster": 2, "code": 15, "col": [], "column": [], "com": [], "comput": 3, "compute_ae_loss": [], "compute_ae_loss_map": [], "compute_ae_loss_pretrain": [], "compute_dis_loss": [], "compute_dis_loss_map": [], "compute_dis_loss_pretrain": [], "compute_gene_embedding_loss": [], "conda": 3, "config": 1, "configur": 6, "consol": 6, "consolid": 2, "construct": [], "construct_data": [], "construct_graph": 9, "construct_mask": [], "contain": [], "context": 2, "core": 2, "creat": 3, "cuda_determinist": [], "customgraphdataload": [], "customgraphdataset": [], "d": [], "data": [2, 9], "data_pth": 9, "dataloader_pretrain_singl": [], "dataloader_pretrain_spati": [], "dataset": 1, "dataset_al": [], "decod": 8, "deem": 6, "deep": 2, "delaunai": 9, "detail": 2, "determin": 6, "devic": [], "dgl": [], "di": [], "dict": [], "dimens": 8, "directori": 3, "dis_a": [], "dis_lamda": [], "disc": 8, "discrimin": 8, "disk1": [], "distribut": [], "doi": 0, "download": [2, 17], "downstream": 2, "drop_last": [], "dropout": 8, "dropout_r": 8, "e": [], "each": 9, "embed": 8, "enc": 8, "encod": 8, "endswith": 9, "enum": [], "enumer": [], "ep": [], "epoch": 8, "epoch_fin": [], "epoch_pretrain": [], "estim": [3, 15], "exampl": [8, 9, 17], "explanatori": 20, "express": 2, "f": 9, "factor": [], "fals": 6, "familiar": 17, "featur": [], "feature_al": [], "file": 6, "filter": 6, "final": [], "flag": [], "flag_source_cat_singl": [], "flag_source_cat_single_pretrain": [], "flag_source_cat_spati": [], "flag_source_cat_spatial_pretrain": [], "flagconfig": [], "float": 8, "follow": 3, "forward": 8, "framework": 2, "from": [2, 3, 17], "function": [2, 9, 17, 20], "fuse_network": 8, "fusemap": [0, 1, 3, 17, 20], "fusemapadaptdecod": 8, "fusemapdecod": 8, "fusemapencod": 8, "g_all": [], "gb": 15, "gene": 8, "gene1": 8, "gene2": 8, "gene_embed": 8, "gene_embedding_new": 8, "gene_embedding_pretrain": 8, "gene_list": 9, "gene_new": 8, "gene_pretrain": 8, "gener": [], "generate_ad_emb": [], "get_allunique_gene_nam": 9, "get_balance_weight": [], "get_balance_weight_subsampl": [], "get_data": [], "get_feature_spars": [], "get_spatial_input": 9, "get_unique_gene_indic": 9, "git": [], "github": [0, 3], "gpu": 3, "graph": 8, "h5ad": 9, "hail": 0, "hao": 0, "he": 0, "here": 17, "hidden": 8, "hidden_dim": 8, "home": [], "hour": 3, "how": 2, "http": 0, "human": [2, 3], "i": [2, 3, 6, 8], "ident": [8, 9], "identif": 2, "ignor": 6, "import": 9, "imput": 2, "includ": [], "index": [], "indic": 8, "inform": [], "input": [2, 8, 9], "input_dim": 8, "input_ident": [8, 9], "instal": 2, "int": [8, 9], "integr": [1, 3, 20], "issu": 0, "j": [], "jia": 0, "jialiulab": [], "k": 9, "keep_celltyp": [], "keep_label": [], "keep_tissueregion": [], "kei": 8, "key_leiden_categori": [], "kneighbor": 9, "kwarg": 8, "lambda_ae_singl": [], "lambda_ae_spati": [], "lambda_disc_singl": [], "lambda_disc_spati": [], "latent": 8, "latent_dim": 8, "layer": 8, "learn": 2, "learning_r": [], "leiden": [], "leiden_adata_singl": [], "len": 9, "list": [6, 8, 9], "listdir": 9, "liu": 0, "llm": 8, "load_ref_data": [], "load_ref_model": [], "load_sample_data": [], "load_snapshot": [], "loc": [], "local": 3, "log": 6, "logger": 1, "loss": 1, "loss_ae_al": [], "loss_al": [], "lr_factor_fin": [], "lr_factor_pretrain": [], "lr_limit_fin": [], "lr_limit_pretrain": [], "lr_patience_fin": [], "lr_patience_pretrain": [], "mai": 6, "main": [], "manner": 3, "map": [1, 20], "map_model": [], "mappretraindataload": [], "mappretraindataset": [], "mask": [], "mask_batch_singl": [], "mask_batch_spati": [], "matric": [], "matrix": 8, "mean": 8, "memori": 15, "merfish": 2, "messag": 6, "method": 9, "min": 15, "mode": [], "model": 2, "modeltyp": [], "modifi": 6, "modul": 1, "molccf": [], "molccf_path": [], "molecular": 0, "mous": [0, 2, 3], "multipleheaderfilt": 6, "n": [3, 8], "n_atla": [8, 9], "n_epoch": [], "n_ob": 8, "name": 8, "namespac": [], "nearest": 9, "necessari": 3, "neighbor": 9, "network": 8, "new": 8, "new_adata": [], "new_train_gen": 8, "nn": [], "nntransfer": 8, "node": 8, "none": [6, 8, 9], "norm": 8, "normal": 8, "notebook": 20, "num_epoch": 8, "number": [8, 9], "o": 9, "ob": [], "object": 9, "objt": [], "observ": 8, "obsm": [], "obsm_lat": [], "optim_kw": [], "org": 0, "organ": [2, 3], "origin": [], "otherwis": 6, "our": [0, 2], "out": [2, 6], "output": [2, 8], "overview": 2, "packag": 2, "page": [], "panel": 2, "para": 8, "paramet": [6, 8, 9], "parse_input_arg": [], "pass": 8, "path": [6, 9], "patience_limit_fin": [], "patience_limit_pretrain": [], "pattern": 6, "patterns_to_filt": 6, "pca": [8, 9], "pca_dim": 8, "perform": 3, "phase": [], "pip": 3, "place": 6, "pleas": 0, "preprocess": 1, "preprocess_adata": 9, "preprocess_adj_spars": 9, "preprocess_raw": 9, "preprocess_sav": [], "pretrain": [2, 8], "pretrain_index": [], "pretrain_model": 8, "pretrain_n_atla": 8, "pretrain_single_batch": [], "pretrain_spatial_batch": [], "pretrained_gen": 8, "prod": [], "product": [], "provid": [1, 2, 20], "public": 0, "put": 3, "python": 3, "quick": 3, "randn": 8, "rate": 8, "raw": 9, "read_cell_embed": [], "read_gene_embed": [], "read_gene_embedding_map": [], "read_h5ad": 9, "read_model": [], "recon_x": [], "reconstruct": [], "record": 6, "ref_dir": [], "refer": 2, "regex": 6, "report": 0, "repres": 9, "reset_paramet": 8, "return": [6, 8], "rmsprop": [], "row": [], "sampl": 8, "sample_gene_list": 9, "sampler": [], "save": [6, 9], "save_dir": [], "save_obj": [], "save_path": 6, "save_snapshot": [], "sc": 9, "scanpi": 9, "scrna": 8, "search": [], "section": [9, 17], "seed_al": [], "seed_valu": [], "seq": 2, "setup_log": 6, "sheng": 0, "shi": 0, "should": 6, "shuffl": [], "singl": [2, 3], "slide": 2, "snapshot_path": [], "sourc": [6, 8, 9], "space": [2, 8], "spatial": [0, 1, 9, 20], "spatial_dataload": [], "spatial_dataloader_test": [], "spatial_dataset_list": [], "spatial_integr": [1, 2], "spatial_map": [1, 2], "speci": 2, "specifi": 6, "spot": 2, "st": 9, "str": [8, 9], "string": 9, "subsampl": [], "support": 2, "tabl": [], "tang": 0, "task": [], "technologi": 2, "tensor": 8, "thi": 17, "time": [3, 15], "tool": 2, "torch": 8, "toward": 0, "tracker": 0, "train": [2, 8], "train_mask": [], "train_model": 1, "train_without_ev": [], "trained_model": [], "trained_x_num": [], "transcriptom": 2, "transfer_annot": [], "transfer_weight": [], "true": 6, "ttype": [], "tutori": [2, 17], "type": [2, 8], "uniqu": 8, "univers": 0, "us": [0, 2, 3, 8, 9, 17], "use_input": [8, 9], "use_kei": [], "use_llm_gene_embed": 8, "use_reference_pct": [], "user": 17, "usual": 3, "util": 2, "val_mask": [], "valid": [], "valu": [], "var_index": 8, "var_nam": 8, "variabl": 8, "varieti": [], "variou": 2, "verbos": [], "visium": 2, "wang": 0, "we": [17, 20], "weight": 8, "weight_norm": 8, "wendi": 0, "where": 6, "whether": 8, "within": 2, "x": 8, "x_input": 9, "xiao": 0, "xueyi": 0, "xx": [3, 15, 17], "xxx": 17, "y": 8, "yichun": 0, "yichunh": [], "you": [0, 3], "z": 8, "z_distribut": [], "z_mean": 8, "z_sampl": 8, "z_spatial": 8, "zefang": 0, "zenodo": 3, "zip": []}, "titles": ["About", "API Reference", "FuseMap", "Installation", "fusemap.config module", "fusemap.dataset module", "fusemap.logger module", "fusemap.loss module", "fusemap.model module", "fusemap.preprocess module", "fusemap.spatial_integrate module", "fusemap.spatial_map module", "fusemap.train module", "fusemap.train_model module", "fusemap.utils module", "Impute spatial gene expression", "Integrate cells and tissues across organs and species", "Integrate cells and tissues in adult mouse brain across atlases", "Map cells and tissues to molCCF", "Map cells and tissues across human/mouse or organs", "Tutorials"], "titleterms": {"": [], "1": 17, "2": 17, "3": 17, "And": [], "about": 0, "across": [16, 17, 19], "adult": 17, "api": 1, "atlas": 17, "author": 0, "brain": 17, "cell": [2, 16, 17, 18, 19], "cite": 0, "config": 4, "content": 2, "core": 1, "data": 17, "dataset": 5, "document": [], "download": 3, "embed": 2, "exampl": [], "express": 15, "function": 1, "fusemap": [2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "gene": [2, 15], "guid": 2, "how": 0, "human": 19, "imput": 15, "indic": [], "instal": 3, "integr": [2, 16, 17], "logger": 6, "loss": 7, "main": [], "map": [2, 18, 19], "model": [1, 3, 8], "modul": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "molccf": 18, "more": [], "mous": [17, 19], "organ": [16, 19], "packag": 3, "prepar": 17, "preprocess": 9, "pretrain": 3, "quick": 2, "read": 17, "refer": 1, "softwar": 17, "spatial": [2, 15, 17], "spatial_integr": 10, "spatial_map": 11, "speci": 16, "start": 2, "step": 2, "support": 0, "tabl": [], "tissu": [2, 16, 17, 18, 19], "train": [1, 12], "train_model": 13, "tutori": 20, "univers": 2, "usag": [], "util": [1, 14], "welcom": []}})