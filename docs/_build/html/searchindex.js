Search.setIndex({"docnames": ["about", "api", "fusemap", "index", "install", "main", "modules", "notebooks/spatial_impute", "notebooks/spatial_integrate_species", "notebooks/spatial_integrate_tech", "notebooks/spatial_map_mousebrain", "notebooks/spatial_map_mousehuman", "tutorials"], "filenames": ["about.rst", "api.rst", "fusemap.rst", "index.rst", "install.rst", "main.rst", "modules.rst", "notebooks/spatial_impute.ipynb", "notebooks/spatial_integrate_species.ipynb", "notebooks/spatial_integrate_tech.ipynb", "notebooks/spatial_map_mousebrain.ipynb", "notebooks/spatial_map_mousehuman.ipynb", "tutorials.rst"], "titles": ["About", "API Reference", "fusemap package", "Welcome to FuseMap\u2019s documentation!", "Installation", "main module", "FuseMap", "Impute spatial gene expression", "Integrate cells and tissues across organs and species", "Integrate cells and tissues in adult mouse brain across atlases", "Map cells and tissues to molCCF", "Map cells and tissues across human/mouse or organs", "Tutorials"], "terms": {"you": [0, 4], "can": [0, 4], "report": 0, "issu": 0, "fusemap": [0, 4, 9, 12], "us": [0, 4, 9], "our": 0, "github": [0, 4], "tracker": 0, "yichun": 0, "he": 0, "To": 0, "public": 0, "pleas": 0, "xx": [0, 4, 9], "biorxiv": 0, "class": 2, "adj_model": [2, 6], "arg": 2, "kwarg": 2, "sourc": 2, "base": 2, "paramet": 2, "ani": 2, "return": 2, "type": [1, 2], "forward": [2, 6], "discrimin": [2, 6], "x": 2, "fusemapadaptdecod": [2, 6], "z": 2, "z_spatial": 2, "adj": 2, "gene_embedding_pretrain": 2, "gene_embedding_new": 2, "fusemapdecod": [2, 6], "fusemapencod": [2, 6], "fuse_network": [2, 6], "add_adaptdecoder_modul": [2, 6], "kei": 2, "var_index": 2, "gene_pretrain": 2, "gene_new": 2, "add_decoder_modul": [2, 6], "gene_embed": 2, "add_encoder_modul": [2, 6], "input_dim": 2, "hidden_dim": 2, "latent_dim": 2, "dropout_r": 2, "0": 2, "1": [2, 3, 4], "nntransfer": [2, 6], "reset_paramet": [2, 6], "para": 2, "overview": 3, "instal": 3, "packag": [3, 6], "download": [3, 9], "pretrain": 3, "model": [3, 6], "tutori": [3, 9], "about": 3, "support": 3, "author": 3, "how": 3, "cite": 3, "i": [1, 3, 4], "deep": 3, "learn": 3, "framework": 3, "transcriptom": 3, "bridg": 3, "singl": [3, 4], "spot": 3, "express": 3, "within": 3, "context": 3, "2": 3, "consolid": 3, "variou": 3, "panel": 3, "across": 3, "technologi": 3, "organ": [3, 4], "speci": 3, "fusmap": 3, "spatial_integr": [3, 6], "provid": [1, 3, 12], "xxx": [3, 9], "spatial_map": [3, 6], "check": 3, "out": 3, "exampl": [3, 9], "index": 3, "modul": [1, 3, 6], "The": 4, "from": [4, 9], "quick": 4, "perform": 4, "pip": 4, "usual": 4, "manner": 4, "git": 4, "clone": 4, "http": 4, "com": 4, "yichunh": 4, "cd": 4, "e": 4, "A": 4, "gpu": 4, "necessari": 4, "acceler": 4, "comput": 4, "estim": 4, "time": 4, "hour": 4, "integr": [4, 12], "300": 4, "000": 4, "cell": [1, 4], "follow": 4, "zenodo": 4, "put": 4, "local": 4, "directori": 4, "mous": [3, 4], "brain": [3, 4], "human": [3, 4], "submodul": 6, "config": 6, "dataset": 6, "logger": 6, "loss": 6, "preprocess": 6, "train": 6, "train_model": 6, "util": [1, 6], "content": 6, "main": 6, "171": [], "import": [], "matplotlib": [], "pyplot": [], "plt": [], "scanpi": [], "sc": [], "panda": [], "pd": [], "numpi": [], "np": [], "o": [], "anndata": [], "ad": [], "241": [], "test": [], "read_h5ad": [], "home": [], "jialiulab": [], "disk1": [], "input_data": [], "mouse_tissue_type_integrate_test3": [], "merfish_mouse_colitis_062221_d9_m3_2_slice_1": [], "h5ad": [], "242": [], "ob": [], "y": [], "mean": [], "780": [], "1002576269227": [], "243": [], "770": [], "244": [], "view": [], "object": [], "n_ob": [], "n_var": [], "11198": [], "943": [], "39": [], "mouse_id": [], "technical_repeat_numb": [], "sample_typ": [], "slice_id": [], "fov": [], "cell_id": [], "sampl": [], "n_gene": [], "tier1": [], "tier2": [], "tier3": [], "leiden_neigh": [], "neigh_umap_x": [], "neigh_umap_i": [], "tier2_umap_x": [], "tier2_umap_i": [], "tier3_umap_x": [], "tier3_umap_i": [], "tier1_umap_x": [], "tier1_umap_i": [], "cell_typ": [], "tissue_region": [], "var": [], "n_cell": [], "highly_vari": [], "dispers": [], "dispersions_norm": [], "un": [], "neigh_anndata": [], "sample_type_color": [], "tier1_color": [], "tier3_color": [], "hvg": [], "leiden": [], "log1p": [], "neighbor": [], "pca": [], "umap": [], "obsm": [], "x_pca": [], "x_umap": [], "spatial_input": [], "varm": [], "pc": [], "obsp": [], "connect": [], "distanc": [], "245": [], "write_h5ad": [], "246": [], "path": [], "x_input": [], "file_nam": [], "f": [], "listdir": [], "isfil": [], "join": [], "ind": [], "file_name_i": [], "enumer": [], "print": [], "try": [], "col": [], "row": [], "except": [], "figur": [], "scatter": [], "": [9, 12], "starmap_mouse_brain": [], "20857": [], "1022": [], "orginindex": [], "n_genes_by_count": [], "log1p_n_genes_by_count": [], "total_count": [], "log1p_total_count": [], "n_count": [], "batch": [], "batch_s_c": [], "rank1_defin": [], "rank2_defin": [], "rank3_defin": [], "rank4_defin": [], "rank1_refin": [], "rank2_refin": [], "rank3_refin": [], "rank4_refin": [], "rank5_symbol_1008": [], "level1_name_refin": [], "sublevel": [], "tissu": [], "region": [], "1110": [], "final_cell_typ": [], "racrna_count_sagitt": [], "racrna_count_coron": [], "domain": [], "gt_cell_type_main": [], "gt_cell_type_sub": [], "gt_tissue_region": [], "gt_tissue_region_main": [], "gt_tissue_region_sub": [], "global_x": [], "global_i": [], "ccf_label": [], "gttaxonomyrank4": [], "gtdescript": [], "gttissueregion": [], "n_cells_by_count": [], "mean_count": [], "log1p_mean_count": [], "pct_dropout_by_count": [], "layer": [], "count": [], "visiumhd_human_colon": [], "26560": [], "18085": [], "in_tissu": [], "array_row": [], "array_col": [], "gene_id": [], "feature_typ": [], "genom": [], "cosmx_human_lung5_rep1": [], "47990": [], "960": [], "cosmx_human_brain": [], "45180": [], "6278": [], "252": [], "save_dir": [], "output": [], "tissue_integrate_test1_llmcombin": [], "ad_embed_o": [], "ad_celltype_embed": [], "253": [], "ad_emb": [], "254": [], "ad_concat": [], "uniqu": [], "ad_embed_i": [], "ad_embed_i_sampl": [], "random": [], "permut": [], "shape": [], "10000": [], "append": [], "concat": [], "255": [], "pp": [], "n_neighbor": [], "50": [], "use_rep": [], "tl": [], "256": [], "fig": [], "ax": [], "subplot": [], "figsiz": [], "3": [], "pl": [], "color": [], "size": [], "show": [], "fals": [], "set_titl": [], "id": [], "text": [], "5": [], "259": [], "loc": [], "sample0": [], "265": [], "6": [], "263": [], "257": [], "10": [], "conda": [], "env": [], "fusemap_glu": [], "lib": [], "python3": [], "7": [], "site": [], "compat": [], "_overloaded_dict": [], "py": [], "106": [], "implicitmodificationwarn": [], "modifi": [], "attribut": 1, "_un": [], "initi": [], "actual": [], "self": [], "data": [], "valu": [], "266": [], "ad_tissueregion_embed": [], "178": [], "267": [], "268": [], "270": [], "120": [], "color_map": [], "rand": [], "nuniqu": [], "dict_al": [], "rang": [], "cat": [], "categori": [], "121": [], "ad_plot": [], "c": [], "titl": [], "84": [], "sample1": [], "lt": [], "collect": [], "pathcollect": [], "0x7f4b7c7a0b10": [], "gt": [], "182": [], "mouse_tissue_integrate_test3_llmcombin": [], "ad_gene_embed": [], "186": [], "astyp": [], "str": [], "191": [], "name": [], "mbassdd83_aaaaaaaaaaagta": [], "1262": [], "3329": [], "section1": [], "slideseq_puck40": [], "nan": [], "mbassdd83_aaaaaaaaaatact": [], "4656": [], "1230": [], "mbassdd83_aaaaaaaaactgaa": [], "4619": [], "4": [], "1618": [], "mbassdd83_aaaaaaactgttca": [], "1614": [], "1472": [], "8": [], "mbassdd83_aaaaaccctcctct": [], "3042": [], "3460": [], "mbassdd83_tttttttttgtgta": [], "2484": [], "9": [], "828": [], "mbassdd83_ttttttttttattg": [], "3712": [], "1569": [], "mbassdd83_ttttttttttgagt": [], "1909": [], "3818": [], "mbassdd83_ttttttttttggtt": [], "4595": [], "4240": [], "mbassdd83_ttttttttttttag": [], "3324": [], "1238": [], "46965": [], "94": [], "column": [], "187": [], "sample2": [], "sample3": [], "0610009b22rik": [], "sample_1": [], "type_sample_1__": [], "0610009e02rik": [], "0610009l18rik": [], "0610010f05rik": [], "0610012g03rik": [], "zxdc": [], "zyg11b": [], "sample_3": [], "type_sample_1__sample_3": [], "zyx": [], "zzef1": [], "zzz3": [], "19868": [], "188": [], "34": [], "tutorial_map2": [], "35": [], "83546": [], "64": [], "fusemap_celltyp": [], "batch_color": [], "36": [], "46": [], "ad_map2": [], "_core": [], "1828": [], "userwarn": [], "observ": [], "ar": [], "make": [], "them": [], "call": [], "obs_names_make_uniqu": [], "warn_names_dupl": [], "ad_map1": [], "tqdm": [], "auto": [], "22": [], "tqdmwarn": [], "iprogress": [], "found": [], "updat": [], "jupyt": [], "ipywidget": [], "see": [], "readthedoc": [], "io": [], "en": [], "stabl": [], "user_instal": [], "html": [], "autonotebook": [], "notebook_tqdm": [], "omp": [], "info": [], "276": [], "omp_set_nest": [], "routin": [], "deprec": [], "omp_set_max_active_level": [], "instead": [], "48": [], "19062": [], "top_level_cell_typ": [], "fusemap_celltype_color": [], "we": [9, 12], "explanatori": 12, "notebook": 12, "spatial": 12, "map": 12, "function": [3, 9, 12], "document": 1, "under": 1, "construct": 1, "current": 1, "focus": 1, "These": 1, "scimilar": 1, "embed": 1, "varieti": 1, "task": 1, "includ": 1, "annot": 1, "queri": 1, "gene": 1, "score": 1, "cell_annot": 1, "api": 3, "refer": 3, "core": 3, "atla": 3, "__init__": [], "n": [], "n_atla": [], "normal": [], "batchnorm": [], "pca_dim": [], "var_nam": [], "all_unique_gen": [], "use_input": [], "input_ident": [], "num_epoch": [], "pretrain_model": [], "pretrain_n_atla": [], "pretrained_gen": [], "none": [], "new_train_gen": [], "use_llm_gene_embed": [], "128": [], "output_dim": [], "imput": 3, "thi": 9, "familiar": 9, "user": 9, "basic": 9, "section": 9, "here": 9}, "objects": {"fusemap": [[2, 0, 0, "-", "model"]], "fusemap.model": [[2, 1, 1, "", "Adj_model"], [2, 1, 1, "", "Discriminator"], [2, 1, 1, "", "FuseMapAdaptDecoder"], [2, 1, 1, "", "FuseMapDecoder"], [2, 1, 1, "", "FuseMapEncoder"], [2, 1, 1, "", "Fuse_network"], [2, 1, 1, "", "NNTransfer"], [2, 3, 1, "", "reset_parameters"]], "fusemap.model.Adj_model": [[2, 2, 1, "", "forward"]], "fusemap.model.Discriminator": [[2, 2, 1, "", "forward"]], "fusemap.model.FuseMapAdaptDecoder": [[2, 2, 1, "", "forward"]], "fusemap.model.FuseMapDecoder": [[2, 2, 1, "", "forward"]], "fusemap.model.FuseMapEncoder": [[2, 2, 1, "", "forward"]], "fusemap.model.Fuse_network": [[2, 2, 1, "", "add_adaptdecoder_module"], [2, 2, 1, "", "add_decoder_module"], [2, 2, 1, "", "add_encoder_module"]], "fusemap.model.NNTransfer": [[2, 2, 1, "", "forward"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"]}, "titleterms": {"about": 0, "support": 0, "author": 0, "how": 0, "cite": 0, "fusemap": [2, 3, 6], "packag": [2, 4], "submodul": 2, "config": 2, "modul": [2, 5], "dataset": 2, "logger": 2, "loss": 2, "model": [2, 4], "preprocess": 2, "spatial_integr": 2, "spatial_map": 2, "train": 2, "train_model": 2, "util": 2, "content": [2, 3], "welcom": 3, "": 3, "document": 3, "spatial": [3, 7, 9], "integr": [3, 8, 9], "univers": 3, "gene": [3, 7], "cell": [3, 8, 9, 10, 11], "tissu": [3, 8, 9, 10, 11], "embed": 3, "usag": 3, "map": [3, 10, 11], "And": 3, "more": 3, "indic": 3, "instal": 4, "download": 4, "pretrain": 4, "main": 5, "read": 9, "singl": [], "tutori": 12, "api": 1, "refer": 1, "core": 1, "function": 1, "imput": 7, "express": 7, "across": [8, 9, 11], "organ": [8, 11], "speci": 8, "adult": 9, "mous": [9, 11], "brain": 9, "atlas": 9, "1": 9, "prepar": 9, "softwar": 9, "data": 9, "2": 9, "3": 9, "molccf": 10, "human": 11, "overview": [], "self": []}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"About": [[0, "about"]], "Support": [[0, "support"]], "Authors": [[0, "authors"]], "How to Cite": [[0, "how-to-cite"]], "Welcome to FuseMap\u2019s documentation!": [[3, "welcome-to-fusemap-s-documentation"]], "Spatial integration and mapping with universal gene, cell, and tissue embeddings.": [[3, "spatial-integration-and-mapping-with-universal-gene-cell-and-tissue-embeddings"]], "Contents": [[3, null]], "Usage": [[3, "usage"]], "Spatial integration": [[3, "spatial-integration"]], "Spatial mapping": [[3, "spatial-mapping"]], "And more!": [[3, "and-more"]], "Indices": [[3, "indices"]], "Installation": [[4, "installation"]], "Installing the package": [[4, "installing-the-package"]], "Downloading the pretrained models": [[4, "downloading-the-pretrained-models"]], "FuseMap": [[6, "fusemap"]], "Impute spatial gene expression": [[7, "Impute-spatial-gene-expression"]], "Integrate cells and tissues across organs and species": [[8, "Integrate-cells-and-tissues-across-organs-and-species"]], "Integrate cells and tissues in adult mouse brain across atlases": [[9, "Integrate-cells-and-tissues-in-adult-mouse-brain-across-atlases"]], "1. Prepare software and data": [[9, "1.-Prepare-software-and-data"]], "2. Read data": [[9, "2.-Read-data"]], "3. Spatial integrate": [[9, "3.-Spatial-integrate"]], "Map cells and tissues to molCCF": [[10, "Map-cells-and-tissues-to-molCCF"]], "Map cells and tissues across human/mouse or organs": [[11, "Map-cells-and-tissues-across-human/mouse-or-organs"]], "Tutorials": [[12, "tutorials"]], "API Reference": [[1, "api-reference"]], "Core Functionality": [[1, "core-functionality"]], "fusemap package": [[2, "fusemap-package"]], "Submodules": [[2, "submodules"]], "fusemap.config module": [[2, "fusemap-config-module"]], "fusemap.dataset module": [[2, "fusemap-dataset-module"]], "fusemap.logger module": [[2, "fusemap-logger-module"]], "fusemap.loss module": [[2, "fusemap-loss-module"]], "fusemap.model module": [[2, "module-fusemap.model"]], "fusemap.preprocess module": [[2, "fusemap-preprocess-module"]], "fusemap.spatial_integrate module": [[2, "fusemap-spatial-integrate-module"]], "fusemap.spatial_map module": [[2, "fusemap-spatial-map-module"]], "fusemap.train module": [[2, "fusemap-train-module"]], "fusemap.train_model module": [[2, "fusemap-train-model-module"]], "fusemap.utils module": [[2, "fusemap-utils-module"]], "Module contents": [[2, "module-contents"]], "main module": [[5, "main-module"]]}, "indexentries": {"adj_model (class in fusemap.model)": [[2, "fusemap.model.Adj_model"]], "discriminator (class in fusemap.model)": [[2, "fusemap.model.Discriminator"]], "fusemapadaptdecoder (class in fusemap.model)": [[2, "fusemap.model.FuseMapAdaptDecoder"]], "fusemapdecoder (class in fusemap.model)": [[2, "fusemap.model.FuseMapDecoder"]], "fusemapencoder (class in fusemap.model)": [[2, "fusemap.model.FuseMapEncoder"]], "fuse_network (class in fusemap.model)": [[2, "fusemap.model.Fuse_network"]], "nntransfer (class in fusemap.model)": [[2, "fusemap.model.NNTransfer"]], "add_adaptdecoder_module() (fusemap.model.fuse_network method)": [[2, "fusemap.model.Fuse_network.add_adaptdecoder_module"]], "add_decoder_module() (fusemap.model.fuse_network method)": [[2, "fusemap.model.Fuse_network.add_decoder_module"]], "add_encoder_module() (fusemap.model.fuse_network method)": [[2, "fusemap.model.Fuse_network.add_encoder_module"]], "forward() (fusemap.model.adj_model method)": [[2, "fusemap.model.Adj_model.forward"]], "forward() (fusemap.model.discriminator method)": [[2, "fusemap.model.Discriminator.forward"]], "forward() (fusemap.model.fusemapadaptdecoder method)": [[2, "fusemap.model.FuseMapAdaptDecoder.forward"]], "forward() (fusemap.model.fusemapdecoder method)": [[2, "fusemap.model.FuseMapDecoder.forward"]], "forward() (fusemap.model.fusemapencoder method)": [[2, "fusemap.model.FuseMapEncoder.forward"]], "forward() (fusemap.model.nntransfer method)": [[2, "fusemap.model.NNTransfer.forward"]], "fusemap.model": [[2, "module-fusemap.model"]], "module": [[2, "module-fusemap.model"]], "reset_parameters() (in module fusemap.model)": [[2, "fusemap.model.reset_parameters"]]}})