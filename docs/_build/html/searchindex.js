Search.setIndex({"alltitles": {"1. Prepare software and data": [[19, "1.-Prepare-software-and-data"]], "2. Read data": [[19, "2.-Read-data"]], "3. Spatial integrate": [[19, "3.-Spatial-integrate"]], "API Reference": [[1, null]], "About": [[0, null]], "And more!": [[2, "and-more"]], "Authors": [[0, "authors"]], "Contents": [[2, null]], "Core Functionality": [[1, "core-functionality"]], "Downloading the pretrained models": [[3, "downloading-the-pretrained-models"]], "FuseMap": [[5, null]], "How to Cite": [[0, "how-to-cite"]], "Impute spatial gene expression": [[17, null]], "Indices": [[2, "indices"]], "Installation": [[3, null]], "Installing the package": [[3, "installing-the-package"]], "Integrate cells and tissues across organs and species": [[18, null]], "Integrate cells and tissues in adult mouse brain across atlases": [[19, null]], "Map cells and tissues across human/mouse or organs": [[21, null]], "Map cells and tissues to molCCF": [[20, null]], "Spatial integration": [[2, "spatial-integration"]], "Spatial integration and mapping with universal gene, cell, and tissue embeddings.": [[2, "spatial-integration-and-mapping-with-universal-gene-cell-and-tissue-embeddings"]], "Spatial mapping": [[2, "spatial-mapping"]], "Support": [[0, "support"]], "Tutorials": [[22, null]], "Usage": [[2, "usage"]], "Welcome to FuseMap\u2019s documentation!": [[2, null]], "fusemap.config module": [[6, null]], "fusemap.dataset module": [[7, null]], "fusemap.logger module": [[8, null]], "fusemap.loss module": [[9, null]], "fusemap.model module": [[10, null]], "fusemap.preprocess module": [[11, null]], "fusemap.spatial_integrate module": [[12, null]], "fusemap.spatial_map module": [[13, null]], "fusemap.train module": [[14, null]], "fusemap.train_model module": [[15, null]], "fusemap.utils module": [[16, null]], "main module": [[4, null]]}, "docnames": ["about", "api", "index", "install", "main", "modules", "modules/config", "modules/dataset", "modules/logger", "modules/loss", "modules/model", "modules/preprocess", "modules/spatial_integrate", "modules/spatial_map", "modules/train", "modules/train_model", "modules/utils", "notebooks/spatial_impute", "notebooks/spatial_integrate_species", "notebooks/spatial_integrate_tech", "notebooks/spatial_map_mousebrain", "notebooks/spatial_map_mousehuman", "tutorials"], "envversion": {"nbsphinx": 4, "sphinx": 63, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1}, "filenames": ["about.rst", "api.rst", "index.rst", "install.rst", "main.rst", "modules.rst", "modules/config.rst", "modules/dataset.rst", "modules/logger.rst", "modules/loss.rst", "modules/model.rst", "modules/preprocess.rst", "modules/spatial_integrate.rst", "modules/spatial_map.rst", "modules/train.rst", "modules/train_model.rst", "modules/utils.rst", "notebooks/spatial_impute.ipynb", "notebooks/spatial_integrate_species.ipynb", "notebooks/spatial_integrate_tech.ipynb", "notebooks/spatial_map_mousebrain.ipynb", "notebooks/spatial_map_mousehuman.ipynb", "tutorials.rst"], "indexentries": {}, "objects": {"fusemap": [[9, 0, 0, "-", "loss"], [10, 0, 0, "-", "model"], [11, 0, 0, "-", "preprocess"], [12, 0, 0, "-", "spatial_integrate"], [13, 0, 0, "-", "spatial_map"], [14, 0, 0, "-", "train"], [15, 0, 0, "-", "train_model"], [16, 0, 0, "-", "utils"]], "fusemap.loss": [[9, 1, 1, "", "AE_Gene_loss"], [9, 1, 1, "", "compute_ae_loss"], [9, 1, 1, "", "compute_ae_loss_map"], [9, 1, 1, "", "compute_ae_loss_pretrain"], [9, 1, 1, "", "compute_dis_loss"], [9, 1, 1, "", "compute_dis_loss_map"], [9, 1, 1, "", "compute_dis_loss_pretrain"], [9, 1, 1, "", "compute_gene_embedding_loss"], [9, 1, 1, "", "get_balance_weight"], [9, 1, 1, "", "get_balance_weight_subsample"], [9, 1, 1, "", "prod"]], "fusemap.model": [[10, 2, 1, "", "Adj_model"], [10, 2, 1, "", "Discriminator"], [10, 2, 1, "", "FuseMapAdaptDecoder"], [10, 2, 1, "", "FuseMapDecoder"], [10, 2, 1, "", "FuseMapEncoder"], [10, 2, 1, "", "Fuse_network"], [10, 2, 1, "", "NNTransfer"], [10, 1, 1, "", "reset_parameters"]], "fusemap.model.Adj_model": [[10, 3, 1, "", "forward"]], "fusemap.model.Discriminator": [[10, 3, 1, "", "forward"]], "fusemap.model.FuseMapAdaptDecoder": [[10, 3, 1, "", "forward"]], "fusemap.model.FuseMapDecoder": [[10, 3, 1, "", "forward"]], "fusemap.model.FuseMapEncoder": [[10, 3, 1, "", "forward"]], "fusemap.model.Fuse_network": [[10, 3, 1, "", "add_adaptdecoder_module"], [10, 3, 1, "", "add_decoder_module"], [10, 3, 1, "", "add_encoder_module"]], "fusemap.model.NNTransfer": [[10, 3, 1, "", "forward"]], "fusemap.preprocess": [[11, 1, 1, "", "construct_graph"], [11, 1, 1, "", "get_allunique_gene_names"], [11, 1, 1, "", "get_spatial_input"], [11, 1, 1, "", "get_unique_gene_indices"], [11, 1, 1, "", "preprocess_adata"], [11, 1, 1, "", "preprocess_adj_sparse"], [11, 1, 1, "", "preprocess_raw"]], "fusemap.spatial_integrate": [[12, 1, 1, "", "spatial_integrate"]], "fusemap.spatial_map": [[13, 1, 1, "", "spatial_map"]], "fusemap.train": [[14, 1, 1, "", "train"]], "fusemap.train_model": [[15, 1, 1, "", "add_pretrain_to_name"], [15, 1, 1, "", "balance_weight"], [15, 1, 1, "", "get_data"], [15, 1, 1, "", "load_ref_data"], [15, 1, 1, "", "load_ref_model"], [15, 1, 1, "", "map_model"], [15, 1, 1, "", "pretrain_model"], [15, 1, 1, "", "read_model"], [15, 1, 1, "", "train_model"], [15, 1, 1, "", "transfer_weight"]], "fusemap.utils": [[16, 1, 1, "", "average_embeddings"], [16, 1, 1, "", "generate_ad_embed"], [16, 1, 1, "", "load_snapshot"], [16, 1, 1, "", "read_cell_embedding"], [16, 1, 1, "", "read_gene_embedding"], [16, 1, 1, "", "read_gene_embedding_map"], [16, 1, 1, "", "save_obj"], [16, 1, 1, "", "save_snapshot"], [16, 1, 1, "", "seed_all"], [16, 1, 1, "", "transfer_annotation"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method"}, "terms": {"": [15, 19, 22], "0": [10, 15], "000": 3, "05": 0, "1": [2, 3, 10, 15], "10": 0, "1101": 0, "2": 2, "2024": 0, "27": 0, "300": 3, "594872": 0, "A": 3, "The": 3, "These": 1, "To": 0, "about": 2, "acceler": 3, "across": 2, "adapt_model": [9, 15], "adata": [9, 11, 15, 16], "adatas_": 9, "add_adaptdecoder_modul": 10, "add_decoder_modul": 10, "add_encoder_modul": 10, "add_pretrain_to_nam": 15, "adj": 10, "adj_al": [9, 15], "adj_model": 10, "ae_gene_loss": 9, "all_unique_gen": 16, "anneal": 9, "api": 2, "arg": [10, 12, 13], "atla": [0, 2], "author": 2, "average_embed": 16, "balance_weight": 15, "balance_weight_single_block": 9, "balance_weight_spatial_block": 9, "base": 10, "basic": 19, "batch_features_al": 9, "batch_siz": 15, "biorxiv": 0, "blocks_al": 15, "brain": [0, 2, 3], "bridg": 2, "can": [0, 3], "categori": 16, "cd": 3, "cell": 3, "check": 2, "cite": 2, "class": 10, "clone": 3, "com": 3, "comput": 3, "compute_ae_loss": 9, "compute_ae_loss_map": 9, "compute_ae_loss_pretrain": 9, "compute_dis_loss": 9, "compute_dis_loss_map": 9, "compute_dis_loss_pretrain": 9, "compute_gene_embedding_loss": 9, "consolid": 2, "construct_graph": 11, "context": 2, "core": 2, "cuda_determinist": 16, "data_pth": [11, 12, 13, 14], "dataloader_pretrain_singl": 15, "dataloader_pretrain_spati": 15, "deep": 2, "devic": 15, "directori": 3, "discrimin": 10, "doi": 0, "download": [2, 19], "dropout_r": 10, "e": 3, "epoch_fin": 16, "epoch_pretrain": 16, "estim": 3, "exampl": [2, 19], "explanatori": 22, "express": 2, "fals": 14, "familiar": 19, "feature_al": 15, "final": 16, "flag_source_cat_singl": 9, "flag_source_cat_single_pretrain": 9, "flag_source_cat_spati": 9, "flag_source_cat_spatial_pretrain": 9, "flagconfig": [9, 15], "follow": 3, "forward": 10, "framework": 2, "from": [3, 19], "function": [2, 19, 22], "fuse_network": 10, "fusemap": [0, 1, 3, 19, 22], "fusemapadaptdecod": 10, "fusemapdecod": 10, "fusemapencod": 10, "g_all": 15, "gene_embed": 10, "gene_embedding_new": 10, "gene_embedding_pretrain": 10, "gene_list": 11, "gene_new": 10, "gene_pretrain": 10, "generate_ad_emb": 16, "get_allunique_gene_nam": 11, "get_balance_weight": 9, "get_balance_weight_subsampl": 9, "get_data": 15, "get_spatial_input": 11, "get_unique_gene_indic": 11, "git": 3, "github": [0, 3], "gpu": 3, "hail": 0, "hao": 0, "he": 0, "here": 19, "hidden_dim": 10, "hour": 3, "how": 2, "http": [0, 3], "human": [2, 3], "i": [2, 3], "imput": 2, "includ": 1, "index": 2, "input_dim": 10, "input_ident": [11, 12, 13, 14], "instal": 2, "integr": [3, 22], "issu": 0, "jia": 0, "keep_celltyp": 16, "keep_label": 16, "keep_tissueregion": 16, "kei": 10, "key_leiden_categori": 9, "kneighbor": [11, 12, 13, 14], "kwarg": 10, "latent_dim": 10, "learn": 2, "leiden_adata_singl": 9, "liu": 0, "load_ref_data": 15, "load_ref_model": 15, "load_snapshot": 16, "loc": 16, "local": 3, "main": 5, "manner": 3, "map": 22, "map_model": 15, "mask_batch_singl": 9, "mask_batch_spati": 9, "mode": 15, "model": [2, 9, 15, 16], "modeltyp": 15, "modul": [1, 2, 5], "molccf_path": [13, 16], "molecular": 0, "mous": [0, 2, 3], "n_atla": [11, 15, 16], "name": 16, "necessari": 3, "new_train_gen": 16, "nntransfer": 10, "none": [11, 12, 13, 14], "notebook": 22, "objt": 16, "obsm_lat": 16, "org": 0, "organ": [2, 3], "our": 0, "out": 2, "overview": 2, "packag": 2, "panel": 2, "para": 10, "perform": 3, "pip": 3, "pleas": 0, "preprocess_adata": 11, "preprocess_adj_spars": 11, "preprocess_raw": 11, "preprocess_sav": 14, "pretrain": 2, "pretrain_index": 15, "pretrain_model": 15, "pretrain_single_batch": 9, "pretrain_spatial_batch": 9, "pretrained_gen": 16, "prod": 9, "provid": [1, 2, 22], "public": 0, "put": 3, "quick": 3, "read_cell_embed": 16, "read_gene_embed": 16, "read_gene_embedding_map": 16, "read_model": 15, "recon_x": 9, "ref_dir": 15, "refer": 2, "report": 0, "reset_paramet": 10, "sample_gene_list": 11, "save_dir": [14, 15, 16], "save_obj": 16, "save_snapshot": 16, "section": 19, "seed_al": 16, "seed_valu": 16, "sheng": 0, "shi": 0, "singl": [2, 3], "snapshot_path": 16, "sourc": [9, 10, 11, 12, 13, 14, 15, 16], "spatial": [0, 22], "spatial_dataload": 15, "spatial_dataloader_test": 15, "spatial_integr": [1, 2], "spatial_map": [1, 2], "speci": 2, "spot": 2, "support": 2, "tang": 0, "task": 1, "technologi": 2, "thi": 19, "time": 3, "toward": 0, "tracker": 0, "train_mask": 15, "trained_model": 15, "trained_x_num": 15, "transcriptom": 2, "transfer_annot": 16, "transfer_weight": 15, "true": 16, "ttype": 16, "tutori": [2, 19], "univers": 0, "us": [0, 3, 19], "use_input": 11, "use_kei": 16, "use_reference_pct": 15, "user": 19, "usual": 3, "val_mask": 15, "var_index": 10, "var_nam": 16, "varieti": 1, "variou": 2, "verbos": 16, "wang": 0, "we": [19, 22], "wendi": 0, "within": 2, "x": [9, 10], "x_input": [11, 12, 13, 14, 16], "xiao": 0, "xueyi": 0, "xx": [1, 3, 19], "xxx": [2, 19], "yichun": 0, "yichunh": 3, "you": [0, 3], "z": 10, "z_distribut": 9, "z_spatial": 10, "zefang": 0, "zenodo": 3}, "titles": ["About", "API Reference", "Welcome to FuseMap\u2019s documentation!", "Installation", "main module", "FuseMap", "fusemap.config module", "fusemap.dataset module", "fusemap.logger module", "fusemap.loss module", "fusemap.model module", "fusemap.preprocess module", "fusemap.spatial_integrate module", "fusemap.spatial_map module", "fusemap.train module", "fusemap.train_model module", "fusemap.utils module", "Impute spatial gene expression", "Integrate cells and tissues across organs and species", "Integrate cells and tissues in adult mouse brain across atlases", "Map cells and tissues to molCCF", "Map cells and tissues across human/mouse or organs", "Tutorials"], "titleterms": {"": 2, "1": 19, "2": 19, "3": 19, "And": 2, "about": 0, "across": [18, 19, 21], "adult": 19, "api": 1, "atlas": 19, "author": 0, "brain": 19, "cell": [2, 18, 19, 20, 21], "cite": 0, "config": 6, "content": 2, "core": 1, "data": 19, "dataset": 7, "document": 2, "download": 3, "embed": 2, "express": 17, "function": 1, "fusemap": [2, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "gene": [2, 17], "how": 0, "human": 21, "imput": 17, "indic": 2, "instal": 3, "integr": [2, 18, 19], "logger": 8, "loss": 9, "main": 4, "map": [2, 20, 21], "model": [3, 10], "modul": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "molccf": 20, "more": 2, "mous": [19, 21], "organ": [18, 21], "packag": 3, "prepar": 19, "preprocess": 11, "pretrain": 3, "read": 19, "refer": 1, "softwar": 19, "spatial": [2, 17, 19], "spatial_integr": 12, "spatial_map": 13, "speci": 18, "support": 0, "tissu": [2, 18, 19, 20, 21], "train": 14, "train_model": 15, "tutori": 22, "univers": 2, "usag": 2, "util": 16, "welcom": 2}})